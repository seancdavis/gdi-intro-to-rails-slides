<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Intro to Ruby on Rails</title>

    <meta name="description" content="An introduction to Ruby on Rails by building a deployable grading application.">
    <meta name="author" content="Sean C Davis">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <link rel="stylesheet" href="css/application.css">
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">

        <section>
          <img src="img/circle-gdi-logo.png" alt="GDI Logo" class="noborder"/>
          <h1>Intro To Rails</h1>
          <p>Instructor: <strong>Sean C Davis</strong></p>
          <p>
            <br>
            <small>
              <a href ="https://github.com/seancdavis/gdi-intro-to-rails-slides"
                 target="_blank">
                Presentation Code
              </a>
            </small>
            <br>
            <small>
              <a href ="https://seancdavis.github.io/gdi-intro-to-rails-slides"
                 target="_blank">
                Presentation Site
              </a>
            </small>
            <br>
            <small>
              <a href ="https://github.com/seancdavis/gdi-ruby-on-rails"
                 target="_blank">
                Course Source Code
              </a>
            </small>
          </p>
        </section>

        <section>
          <h2>Introduction</h2>
          <p>Who are you?</p>
          <ul class="fragment">
            <li>
              What's your name?
            </li>
            <li>
              What do you want to learn? (Why are you here?)
            </li>
            <li>
              Where is your favorite place in the world?
            </li>
          </ul>
        </section>

        <section>
          <h2>Class Rules</h2>
          <ul class="fragment">
            <li>
              This is a safe place
            </li>
            <li>
              There are no dumb questions
            </li>
            <li>
              Be curious and ask
            </li>
            <li>
              (But we have to move fast)
            </li>
            <li>
              Respect each other
            </li>
            <li>
              Have fun!
            </li>
          </ul>
        </section>

        <section>
          <h2>Teams</h2>
          <p>
            We're going to be actively learning throughout these sessions.
          </p>
          <p>
            Each team needs:
          </p>
          <ul class="fragment">
            <li>
              2 people
            </li>
            <li>
              A name
            </li>
            <li>
              A mascot
            </li>
          </ul>
        </section>

        <section>
          <h2>Sessions</h2>
          <ol>
            <li>Intro, Background, and Theory</li>
            <li>CRUD (Create, Read, Update, Delete)</li>
            <li>Data Relationships</li>
            <li>(BONUS!) Deploy to Heroku</li>
          </ol>
        </section>

        <section>
          <h1>
            Session 1:
            <br>
            <small>Intro, Background, Theory</small>
          </h1>
        </section>

        <section>
          <h2>A Good Developer</h2>
          <p>
            Everyone can be a developer, but there are a few points to
            understand.
          </p>
        </section>

        <section data-background-image="https://media.giphy.com/media/yow6i0Zmp7G24/giphy.gif">
          <h2 class="text-white">There's No Secret</h2>
        </section>

        <section data-background-image="https://media.giphy.com/media/Ub8XEam5vXbMY/giphy.gif">
          <h2 class="text-white">Push Through Failure</h2>
        </section>

        <section data-background-image="https://media.giphy.com/media/Lt3qObVV60Qda/giphy.gif">
          <h2 class="text-white">Be Elated By Success</h2>
        </section>

        <section data-background-image="https://media.giphy.com/media/3ornjMfYXNDHHfowqA/giphy.gif">
          <h2 class="text-white">Work Hard</h2>
        </section>

        <section data-background-image="https://media.giphy.com/media/3ohzdPM43X326fUNnW/giphy.gif">
          <h2 class="text-white">Google Is Your Best Friend!</h2>
        </section>

        <section data-background-image="https://media.giphy.com/media/BhzQ7bda46OM8/giphy.gif">
          <h2 class="text-white">Stay Organized</h2>
        </section>

        <section data-background-image="https://media.giphy.com/media/gakFJlGxuBitq/giphy.gif">
          <h2 class="text-white">Be Curious</h2>
        </section>

        <section>
          <h1>Some Theory</h1>
        </section>

        <section>
          <h2>Object-Oriented Programming:</h2>
          <ul>
            <li class="fragment">Everything is an object</li>
            <li class="fragment">Objects have attributes</li>
            <li class="fragment">Objects have methods</li>
          </ul>
<pre class="fragment"><code class="ruby">class Book
  attr_accessor :title

  def reverse_title
    title.reverse
  end
end

book = Book.new # => #&lt;Book:0x007fbcf48c8120&gt;
book.title = 'American Gods'
book.title # => 'American Gods'

book.title = 'The Martian'
book.title # => 'The Martian'

book.reverse_title # => 'naitraM ehT'
</code></pre>
        </section>

        <section>
          <h1>Rails</h1>
        </section>

        <section>
          <h2>Rails is:</h2>
          <ul>
            <li class="fragment">Server-Side Web Application Framework</li>
            <li class="fragment">Written in Ruby</li>
            <li class="fragment">
              Used by 1.2M Sites:<br>Basecamp, AirBNB, GitHub, Dribble
            </li>
            <li class="fragment">Productive</li>
            <li class="fragment">Fun!</li>
          </ul>
        </section>

        <section>
          <h2>Rails Principles:</h2>
          <ul>
            <li class="fragment">
              Don't Repeat Yourself
              (<a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a>)
            </li>
            <li class="fragment">Convention Over Configuration (The Rails Way)</li>
          </ul>
        </section>

        <section>
          <h2>HTML, CSS, and JavaScript?</h2>
          <ul>
            <li class="fragment">They still play a big role</li>
          </ul>
          <br><br>
          <h3 class="fragment">Rails gives us:</h3>
          <ul>
            <li class="fragment">Dynamic data (database)</li>
            <li class="fragment">Flexibility</li>
            <li class="fragment">Scalability</li>
          </ul>
        </section>

        <section>
          <h1>Let's Get To Work</h1>
        </section>

        <section>
          <h2>Cloud9</h2>
          <ul>
            <li class="fragment">
              A hosted development environment
            </li>
            <li class="fragment">
              Usually you'll be local (text editor and command line)
            </li>
            <li class="fragment">
              This saves us setup time
            </li>
            <li class="fragment">
              I will help you setup üçª ‚òïÔ∏è
            </li>
          </ul>
        </section>

        <!-- <section>
          <h2>Demo</h2>
          <p>
            We're going to build a classroom organization system!
          </p>
          <p>
            See demo at
            <a href="https://goo.gl/iEVgjT" target="_blank">
              https://goo.gl/iEVgjT
            </a>.
          </p>
        </section> -->

        <section>
          <h2>Cloud9 Setup</h2>
          <ol>
            <li class="fragment">
              Sign up for an account at https://c9.io/signup
            </li>
            <li class="fragment">
              Create a new workspace (https://c9.io/new)
            </li>
            <li class="fragment">
              Call it <code>gdi-intro-to-rails</code>
            </li>
            <li class="fragment">
              Clone from this URL: <code>git@github.com:seancdavis/gdi-intro-to-rails.git</code>
            </li>
          </ol>
        </section>

        <section>
          <h2>Cloud9 Setup</h2>
          <ol>
            <li class="fragment">
              Install bundler: <code>gem install bundler</code>
            </li>
            <li class="fragment">
              Install ruby gems: <code>bundle install</code>
            </li>
            <!-- Now you can start the server with `rails s -b 0.0.0.0` -->
          </ol>
          <br><br>
          <h3 class="fragment">Bundler</h3>
          <ul>
            <li class="fragment">A package manager</li>
            <li class="fragment">Helps manage ruby gems (packages)</li>
            <li class="fragment">Gems make developing a lot easier</li>
          </ul>
        </section>

        <section>
          <h2>A Simple HTML Site</h2>
          <img src="img/html-file-structure.png" alt="">
        </section>

        <section>
          <h2>A Rails App</h2>
          <img src="img/rails-file-structure.png" alt="">
        </section>

        <section data-background-image="https://media.giphy.com/media/NRXleEopnqL3a/giphy.gif">
          <h2 class="text-white">Uh, WTF?</h2>
        </section>

        <section>
          <h2>Good news!</h2>
          <p>
            We will spend most of our time within the <code>app</code> folder
            (directory).
          </p>
        </section>

        <section>
          <h2>Still, Let's Peek</h2>
          <ul>
            <li><code>app:</code> Holds the files you'll create to build the app</li>
            <li><code>bin:</code> A place Rails keeps its command-line scripts</li>
            <li><code>config:</code> A handful of configuration files</li>
            <li><code>db:</code> Files related to the database</li>
            <li><code>lib:</code> General class files and rake tasks</li>
            <li><code>log:</code> A place to hold log files</li>
            <li><code>public:</code> The technical root of your project</li>
            <li><code>test:</code> Where all the test files go</li>
            <li><code>tmp:</code> Houses temporary files that are regularly deleted</li>
            <li><code>vendor:</code> Third-party assets</li>
          </ul>
        </section>

        <section>
          <h2>The App Directory</h2>
          <img src="img/rails-app-file-structure.png" alt="">
        </section>

        <section>
          <h2>Model-View-Controller (MVC)</h2>
          <img src="img/mvc-diagram.png" alt="">
        </section>

        <section>
          <h2>If MVC Were A Painting</h2>
          <ul>
            <li class="fragment">Model = Paint</li>
            <li class="fragment">Controller = Artist</li>
            <li class="fragment">View = Canvas</li>
          </ul>
        </section>

        <section>
          <h2>The App Directory</h2>
          <ul>
            <li><code>assets:</code> Images, videos, fonts, stylesheets, javascripts, etc.</li>
            <li><code>channels:</code> For websockets (we won't use)</li>
            <li><code>controllers:</code> Files that control app logic</li>
            <li><code>helpers:</code> Shared code for view files</li>
            <li><code>jobs:</code> Background processes (we won't use)</li>
            <li><code>mailers:</code> Controllers for emails</li>
            <li><code>models:</code> Data models (controls for the database)</li>
            <li><code>views:</code> HTML view files</li>
          </ul>
        </section>

        <section>
          <h2>Homework!</h2>
          <p>
            If you aren't familiar with HTML take a brief introductory
            tutorial or course.
          </p>
        </section>

        <section>
          <h1>
            Session 2: CRUD
            <br>
            <small>Create, Read, Update, Delete</small>
          </h1>
        </section>

        <section>
          <h2>Database</h2>
          <ul>
            <li class="fragment">
              A database is like a file cabinet for your app
            </li>
            <li class="fragment">
              It's kind of like Excel, if Excel didn't suck
            </li>
          </ul>
        </section>

        <section>
          <h2>Let's Write Some Code</h2>
          <p>
            Today we're going to focus on building out the logic and
            interactivity behind the student model.
          </p>
        </section>

        <section>
          <h2>Models</h2>
          <p>Data objects used by the application.</p>
          <br>
          <p class="fragment">
            They usually represent a table in our database.
          </p>
          <br>
          <p class="fragment">What will our app require?</p>
          <ul>
            <li class="fragment">Student</li>
            <li class="fragment">Teacher</li>
            <li class="fragment">Classroom</li>
            <!--<li class="fragment">Assignment</li>-->
            <!--<li class="fragment">Score</li>-->
          </ul>
        </section>

        <section>
          <h2>Attributes</h2>
          <p>
            An attribute is a piece of information about a model.
          </p>
          <p>
            Attributes are (usually) <strong>database columns</strong>.
          </p>
          <br>
          <p class="fragment">
            Think: how you refine an Amazon.com search.
          </p>
          <br>
          <p class="fragment">What attributes should our students have?</p>
          <ul>
            <li class="fragment">Name (String)</li>
            <li class="fragment">Age (Integer)</li>
          </ul>
        </section>

        <section>
          <h2>Rails Generators</h2>
          <p>
            Rails comes with a set of <strong>generators</strong> that remove
            the need of performing some boring and repeatable tasks.
          </p>
          <p>
            We can see the tasks available to us by running:
          </p>
<pre class="fragment"><code class="shell-command">$ rails generate

Rails:
  assets
  channel
  controller
  generator
  helper
  integration_test
  jbuilder
  job
  mailer
  migration
  model
  resource
  scaffold
  scaffold_controller
  system_test
  task
</code></pre>
        </section>

        <section>
          <h2>Team Challenge</h2>
          <p>
            What should I run on the command line to create a scaffold for a
            student model with its attributes being a name as a string and
            an age as an integer?
          </p>
          <div class="fragment">
            <br>
            <h3>Answer</h3>
            <pre><code class="console" data-trim>
$ rails generate scaffold student name:string age:integer
            </code></pre>
          </div>
        </section>

        <section>
          <h2>Student Scaffold</h2>
          <p>Notice the output of that command:</p>
          <pre class="fragment"><code class="console" data-trim>
invoke  active_record
create    db/migrate/20170601105024_create_students.rb
create    app/models/student.rb
invoke    test_unit
create      test/models/student_test.rb
create      test/fixtures/students.yml
invoke  resource_route
 route    resources :students
invoke  scaffold_controller
create    app/controllers/students_controller.rb
invoke    erb
create      app/views/students
create      app/views/students/index.html.erb
create      app/views/students/edit.html.erb
create      app/views/students/show.html.erb
create      app/views/students/new.html.erb
create      app/views/students/_form.html.erb
invoke    test_unit
create      test/controllers/students_controller_test.rb
invoke    helper
create      app/helpers/students_helper.rb
invoke      test_unit
invoke    jbuilder
create      app/views/students/index.json.jbuilder
create      app/views/students/show.json.jbuilder
create      app/views/students/_student.json.jbuilder
invoke  test_unit
create    test/system/students_test.rb
invoke  assets
invoke    coffee
create      app/assets/javascripts/students.coffee
invoke    scss
create      app/assets/stylesheets/students.scss
invoke  scss
create    app/assets/stylesheets/scaffolds.scss
          </code></pre>
        </section>

        <section>
          <h2>Student Scaffold</h2>
          <p>
            Let's step through the files we're going to use and see what they
            each do.
          </p>
        </section>

        <section>
          <h2>Data Migration</h2>
          <p>
            Data migrations run a task within the database
            <br>
            (so you don't have to write ugly SQL code).
          </p>
          <br>
          <div class="fragment">
            <p>This:</p>
            <pre><code class="ruby" data-trim>
create_table :students do |t|
  t.string :name
  t.integer :age

  t.timestamps
end
            </code></pre>
          </div>
          <br>
          <div class="fragment">
            <p>
              Is the equivalent of this, in SQL code:
            </p>
            <pre><code class="console" data-trim>
  CREATE TABLE "students" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "age" integer, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL);
            </code></pre>
          </div>
        </section>

        <section>
          <h2>Team Challenge</h2>
          <p>
            We have a data migration file ready, but we don't have a database.
            <br>
            How do I create a database?
          </p>
          <div class="fragment">
            <br>
            <h3>Answer</h3>
            <pre><code class="console" data-trim>
$ rails db:create
            </code></pre>
          </div>
        </section>

        <section>
          <h2>Team Challenge</h2>
          <p>
            Now that we have a database, how do we run the migration?
          </p>
          <div class="fragment">
            <br>
            <h3>Answer</h3>
            <pre><code class="console" data-trim>
$ rails db:migrate
            </code></pre>
          </div>
        </section>

        <section>
          <h2>Data Migration</h2>
          <p>
            During the first migration, a new file gets created for you:
            <code>db/schema.rb</code>. It stores a snapshot of your database's
            structure.
          </p>
          <br>
          <div class="fragment">
            <p>It also looks like migration (ruby) code:</p>
            <pre><code class="ruby" data-trim>
ActiveRecord::Schema.define(version: 20170601102352) do

  create_table "students", force: :cascade do |t|
    t.string "name"
    t.integer "age"
    t.datetime "created_at", null: false
    t.datetime "updated_at", null: false
  end

end
            </code></pre>
          </div>
        </section>

        <section>
          <h2>Student Model</h2>
          <p>
            The generator also gave you a student model in
            <code>app/models/student.rb</code>:
          </p>
          <pre><code class="ruby" data-trim>
class Student < ApplicationRecord
end
          </code></pre>
          <br>
          <p class="fragment">
            This means your app now has a <code>Student</code> class which
            inherits from an <code>ApplicationRecord</code> class.
          </p>
          <br>
          <p class="fragment">
            In Ruby, every class is just an object.
          </p>
        </section>

        <section>
          <h2>Rails Console</h2>
          <p>
            Before we go any further, let's stop for a minute and talk about
            the rails console and server.
          </p>
          <p class="fragment">
            The console is a live and interactive program to work with your
            app's data.
          </p>
          <div class="fragment">
            <p>
              Start it by running:
            </p>
            <pre><code class="console" data-trim>
$ rails console
            </code></pre>
          </div>
        </section>

        <section>
          <h2>Rails Console</h2>
          <p>
            We can interact with objects within our app. Here are a few
            examples:
          </p>
          <pre><code class="console" data-trim>
&gt; Student.all
=> []

&gt; Student.new
=> #&lt;Student id: nil, name: nil, age: nil, created_at: nil, updated_at: nil, classroom_id: nil>
          </code></pre>
          <p class="fragment">
            We will come back to this on occasion for examples.
          </p>
        </section>

        <section>
          <h2>Rails Server</h2>
          <p>
            And before we jump into the code, let's see what our app looks like
            by starting the server.
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ rails server -b 0.0.0.0
          </code></pre>
          <p class="fragment">
            Then we have to locate the correct URL.
          </p>
        </section>

        <section>
          <h2>Rails Server</h2>
          <p>
            At this point, all we have is a static page.
            <br>
            Where the heck did it come from?
          </p>
          <img src="img/rails-home-page.png" alt="">
        </section>

        <section>
          <h2>Rails Server</h2>
          <p>
            It's the default Rails home page because we aren't telling
            Rails what to do with our home page.
          </p>
        </section>

        <section>
          <h2>Routes</h2>
          <p>
            Routes in Rails are URL paths/fragments that tell Rails which
            controller is responsible based on the current URL.
            <br>
            <br>
            (Don't worry, this will make more sense soon!)
          </p>
          <br>
          <div class="fragment">
            <p>Check out <code>config/routes.rb</code>:</p>
            <pre><code class="ruby" data-trim>
Rails.application.routes.draw do
  resources :students
end
            </code></pre>
          </div>
          <br>
          <p class="fragment">
            What the heck does this mean?
          </p>
        </section>

        <section>
          <h2>Team Challenge</h2>
          <p>
            I want to see all the routes available in my application.
            <br>
            How do I do that?
          </p>
          <div class="fragment">
            <br>
            <h3>Answer</h3>
            <pre><code class="console" data-trim>
$ rails routes
            </code></pre>
          </div>
        </section>

        <section>
          <h2>Routes</h2>
          <p>
            Take a look at the output of that command:
          </p>
          <pre><code class="console">
    Prefix Verb   URI Pattern                  Controller#Action
  students GET    /students(.:format)          students#index
            POST   /students(.:format)          students#create
new_student GET    /students/new(.:format)      students#new
edit_student GET    /students/:id/edit(.:format) students#edit
    student GET    /students/:id(.:format)      students#show
            PATCH  /students/:id(.:format)      students#update
            PUT    /students/:id(.:format)      students#update
            DELETE /students/:id(.:format)      students#destroy
          </code></pre>
          <br>
          <p class="fragment">
            There's a lot going on here, and we will cover it all, but for now
            notice that we have no home (root) path, which would be
            <code>/</code>.
          </p>
        </section>

        <section>
          <h2>Routes</h2>
          <p>
            So, add the root path in <code>config/routes.rb</code>.
            <br>
          </p>
          <pre><code class="ruby" data-trim>
Rails.application.routes.draw do
  resources :students
  <mark>root to: 'students#index'</mark>
end
          </code></pre>
          <br>
          <p class="fragment">
            This means the root of our application points to the
            <code>index</code> action of the <code>students</code> controller.
            <br>
            <br>
            <strong>
              (It's also important to know that the root path goes on the
              bottom of the routes file.)
            </strong>
          </p>
        </section>

        <section>
          <h2>Routes</h2>
          <p>
            Let's look at our routes again
          </p>
          <pre><code class="console" data-trim>
$ rails routes
          </code></pre>
          <br>
          <div class="fragment">
            <p>
              Notice the new line at the bottom:
            </p>
            <pre><code class="console">
        root GET    /                            students#index
            </code></pre>
          </div>
          <br>
          <p class="fragment">
            Awesome! Now reload the home page and see what we've got.
          </p>
        </section>

        <section data-background-image="https://media.giphy.com/media/11sBLVxNs7v6WA/giphy.gif">
          <h2 class="text-white">It Works!</h2>
        </section>

        <section>
          <h2>Rails Server</h2>
          <p>
            OK, cool, but <strong>why</strong> does it work?
          </p>
        </section>

        <section>
          <h2>Page Loading Process</h2>
          <ol>
            <li>
              When you navigate to a page in the app, Rails first looks at
              your <code>config/routes.rb</code> file.
            </li>
            <li class="fragment">
              Since you went to the home page, Rails matched that route and
              sent it to the <code>index</code> action of the
              <code>students</code> controller.
            </li>
            <li class="fragment">
              The <code>index</code> method did some stuff, and then Rails
              knew to render the student's <code>index</code> view.
            </li>
          </ol>
          <br>
          <br>
          <p class="fragment">
            Cool, so let's dig into #2 and #3.
          </p>
        </section>

        <section>
          <h2>Student Controller</h2>
          <p>
            The file in <code>app/controllers/students_controller.rb</code>
            is your students controller.
          </p>
          <p>
            It's a long file, but look at the <code>index</code> method
            specifically. (Methods are called actions when they lead to a route
            being rendered.)
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
def index
  @students = Student.all
end
          </code></pre>
          <br>
          <p class="fragment">
            In ruby, <code>@</code> means the variable is an instance variable.
            <br>
            For us that means it is also available to the view.
          </p>
          <p class="fragment">
            <code>Student</code> is our student model (remember it's a class),
            and <code>.all</code> means we're callng the <code>all</code>
            method on the student class.
          </p>
          <p class="fragment">
            <code>all</code> is an ActiveRecord query that returns all students
            found in the database.
          </p>
        </section>

        <section>
          <h2>Student Index View</h2>
          <p>
            The file in <code>app/views/students/index.html.erb</code>
            is the <code>index</code> view for students.
          </p>
          <p>
            It's mostly HTML, isn't it?
          </p>
          <pre class="fragment"><code class="html" data-trim>
&lt;table>
  &lt;thead>
    &lt;tr>
      &lt;th>Name&lt;/th>
      &lt;th>Age&lt;/th>
      &lt;th colspan="3">&lt;/th>
    &lt;/tr>
  &lt;/thead>

  &lt;tbody>
    &lt;% @students.each do |student| %>
      &lt;tr>
        &lt;td>&lt;%= student.name %>&lt;/td>
        &lt;td>&lt;%= student.age %>&lt;/td>
        &lt;td>&lt;%= link_to 'Show', student %>&lt;/td>
        &lt;td>&lt;%= link_to 'Edit', edit_student_path(student) %>&lt;/td>
        &lt;td>&lt;%= link_to 'Destroy', student, method: :delete, data: { confirm: 'Are you sure?' } %>&lt;/td>
      &lt;/tr>
    &lt;% end %>
  &lt;/tbody>
&lt;/table>
          </code></pre>
        </section>

        <section>
          <h2>Student Index View</h2>
          <p>
            The <code><% %></code> symbols are called <em>embedded ruby</em>.
          </p>
          <p>
            When this view is rendered, the embedded ruby code is transformed
            to HTML code, and then the entire HTML file is sent to the browser.
          </p>
          <p>
            That's why the view may look like this when it's presented:
          </p>
          <pre class="fragment"><code class="html" data-trim>
&lt;table>
  &lt;thead>
    &lt;tr>
      &lt;th>Name&lt;/th>
      &lt;th>Age&lt;/th>
      &lt;th colspan="3">&lt;/th>
    &lt;/tr>
  &lt;/thead>

  &lt;tbody>
      &lt;tr>
        &lt;td>Nick Cage&lt;/td>
        &lt;td>53&lt;/td>
        &lt;td>&lt;a href="/students/1">Show&lt;/a>&lt;/td>
        &lt;td>&lt;a href="/students/1/edit">Edit&lt;/a>&lt;/td>
        &lt;td>&lt;a data-confirm="Are you sure?" rel="nofollow" data-method="delete" href="/students/1">Destroy&lt;/a>&lt;/td>
      &lt;/tr>
      &lt;tr>
        &lt;td>Emma Watson&lt;/td>
        &lt;td>27&lt;/td>
        &lt;td>&lt;a href="/students/3">Show&lt;/a>&lt;/td>
        &lt;td>&lt;a href="/students/3/edit">Edit&lt;/a>&lt;/td>
        &lt;td>&lt;a data-confirm="Are you sure?" rel="nofollow" data-method="delete" href="/students/3">Destroy&lt;/a>&lt;/td>
      &lt;/tr>
  &lt;/tbody>
&lt;/table>
          </code></pre>
        </section>

        <section>
          <h2>Student Index View</h2>
          <p>
            Some additional notes on ruby embedded in this file:
          </p>
          <ul>
            <li class="fragment">
              <code>@students</code> is the variable the view received from
              the controller calling <code>@student = Student.all</code>
            </li>
            <li class="fragment">
              <code>each</code> is a method available on arrays in ruby
              (<code>@students</code> isn't <em>really</em> an array, but let's
              ignore that for now)
              that enables us to loop through each student.
            </li>
            <li class="fragment">
              So <code>@students.each do |student|</code> loops through each
              student, setting each to a temporary <code>student</code>
              variable.
            </li>
            <li class="fragment">
              We can call <code>name</code> and <code>age</code> on
              <code>student</code> because we added those as attributes.
            </li>
            <li class="fragment">
              <code>link_to</code> is a rails helper for resolving anchor tags.
            </li>
            <li class="fragment">
              Rails also has route helpers. It knows that
              <code>edit_student_path(student)</code> should be the edit path
              for that student. (Run <code>rails routes</code> again.)
            </li>
            <li class="fragment">
              Adding an equals sign at the beginning of an embedded ruby
              section will output the result in text to the page.
            </li>
          </ul>
        </section>

        <section>
          <h2>Student Index View</h2>
          <p>
            Try some experimentation and see what happens. After each, refresh
            the browser on the home page.
          </p>
          <ul>
            <li class="fragment">
              Change the page heading
            </li>
            <li class="fragment">
              Change a column heading
            </li>
            <li class="fragment">
              Change <code>'Destroy'</code> to <code>'Delete'</code>
            </li>
            <li class="fragment">
              Change <code>person.name</code> to <code>person.title</code>
            </li>
            <li class="fragment">
              Add <code>=</code> to the beginning of the students loop.
            </li>
          </ul>
        </section>

        <section>
          <h2>Creating A Student</h2>
          <p>
            Next, let's break down the process of how a student is created.
          </p>
          <ul>
            <li class="fragment">
              When you click "New Student" you follow the
              <code>new_student_path</code>.
            </li>
            <li class="fragment">
              Notice the URL (<code>/students/new</code>).
            </li>
            <li class="fragment">
              The route points to the <code>new</code> action.
            </li>
            <li class="fragment">
              <code>new</code> sets the <code>@student</code> variable
              to <code>Student.new</code>.
            </li>
            <li class="fragment">
              Calling <code>.new</code> on a class returns a new
              <em>instance</em> of that class (which is just another object).
              So, you have a student, but the student doesn't have a name,
              age, or id yet.
            </li>
          </ul>
        </section>

        <section>
          <h2>Creating A Student</h2>
          <p>
            Take a look at the view in
            <code>app/views/students/new.html.erb</code>.
          </p>
          <pre class="fragment"><code class="erb" data-trim>
&lt;h1>New Student&lt;/h1>

&lt;%= render 'form', student: @student %>

&lt;%= link_to 'Back', students_path %>
          </code></pre>
        </section>

        <section>
          <h2>Team Challenge</h2>
          <p>
            There is obviously a form on the page. It came from the
            <code>render 'form'</code> line.
            <br>
            But what is that line doing?
          </p>
          <div class="fragment">
            <br>
            <h3>Answer</h3>
            <p>
              Within a view, <code>render</code> looks for a
              <em>partial</em>, which is a view with the name you pass as an
              argument.
            </p>
            <p>
              Partials are preceded by an underscore, so it's looking for
              <code>_form.html.erb</code>
            </p>
          </div>
        </section>

        <section>
          <h2>Creating A Student</h2>
          <p>
            Go find a <code>_form.html.erb</code> file within the same directory
            as the new view.
          </p>
          <pre class="fragment"><code class="erb" data-trim>
&lt;%= form_with(model: student, local: true) do |form| %>
  &lt;% if student.errors.any? %>
    &lt;div id="error_explanation">
      &lt;h2>&lt;%= pluralize(student.errors.count, "error") %> prohibited this student from being saved:&lt;/h2>

      &lt;ul>
      &lt;% student.errors.full_messages.each do |message| %>
        &lt;li>&lt;%= message %>&lt;/li>
      &lt;% end %>
      &lt;/ul>
    &lt;/div>
  &lt;% end %>

  &lt;div class="field">
    &lt;%= form.label :name %>
    &lt;%= form.text_field :name, id: :student_name %>
  &lt;/div>

  &lt;div class="field">
    &lt;%= form.label :age %>
    &lt;%= form.number_field :age, id: :student_age %>
  &lt;/div>

  &lt;div class="actions">
    &lt;%= form.submit %>
  &lt;/div>
&lt;% end %>
          </code></pre>
          <p class="fragment">
            There, that looks better!
          </p>
        </section>

        <section>
          <h2>Creating A Student</h2>
          <p>
            Let's talk about the form:
          </p>
          <ul>
            <li class="fragment">
              <code>form_with</code> is a form-building helper. (Notice the
              equals sign before it. Forms need to be rendered to the page.)
            </li>
            <li class="fragment">
              Because we have <code>model: student</code> as an argument to
              <code>form_with</code>, <code>form.text_field :name</code>
              will add a field for a student's name.
            </li>
            <li class="fragment">
              <code>form.submit</code> adds a button that submits the form.
            </li>
          </ul>
        </section>

        <section>
          <h2>Creating A Student</h2>
          <p>
            Because we have <code>form_with(model: student)</code>, Rails knows
            where to submit the form. (This gets more complicated when our
            routes file becomes more complex, but that's OK for now.)
          </p>
          <p class="fragment">
            This means clicking the button sends the data within the form to
            the <code>create</code> action on the students controller.
          </p>
        </section>

        <section>
          <h2>Creating A Student</h2>
          <p>
            In the <code>create</code> action, the student get initialized
            like in new, except this time, it adds <code>student_params</code>
            as an argument.
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
@student = Student.new(student_params)
          </code></pre>
          <p class="fragment">
            <code>student_params</code> is a private method at the bottom of
            the controller. (In this case, <em>private</em> just means it's
            not a controller action.)
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
params.require(:student).permit(:name, :age)
          </code></pre>
          <p class="fragment">
            This uses a Rails way of pulling the data from the request via
            <code>params</code> and tells us which parameters are allowed.
            (We'll come back to this later.)
          </p>
        </section>

        <section>
          <h2>Creating A Student</h2>
          <p>
            The rest of the <code>create</code> action has a lot going on,
            but this is really all it's doing for our case:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
if @student.save
  redirect_to @student, notice: 'Student was successfully created.'
else
  render :new
end
          </code></pre>
          <p class="fragment">
            In other words, <em>if</em> the student can be saved, then we
            redirect to the student (i.e. the <code>show</code> action for that
            new student).
          </p>
          <p class="fragment">
            If the student can <strong>not</strong> be saved, then we
            render the <code>new</code> view. (This is a way to render a view
            without redirecting. And we'll explore that next.)
          </p>
        </section>

        <section>
          <h2>Validations</h2>
          <p>
            Did you notice you can create a student with no data?
            <br>
            Doesn't that seem silly?
          </p>
          <p class="fragment">
            Why don't we make sure that we at least need a name to be able to
            create a student.
          </p>
          <p class="fragment">
            Add the following to your student model:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
validates_presence_of :name
          </code></pre>
          <p class="fragment">
            This means the student model is going to require that name be
            present or it won't let the student be saved.
          </p>
        </section>

        <section>
          <h2>Validations</h2>
          <p>
            Try to create the student again, and notice the errors.
          </p>
          <img src="img/student-name-validation-error.png">
        </section>

        <section>
          <h2>Validations</h2>
          <p class="fragment">
            Look back at the controller. In this case, the <code>create</code>
            action could not save the student, so it rendered the
            <code>new</code> view again without reloading the page.
          </p>
          <p class="fragment">
            We don't want the page reloaded because we still have the student
            object we <em>tried</em> to create, which helps that student's
            attributes persist.
          </p>
          <p class="fragment">
            I know, it's weird. But check it out. Try to create a new student
            with only an age. Notice how the age is still there? Isn't that
            the third coolest thing ever?
          </p>
        </section>

        <section>
          <h2>Editing A Student</h2>
          <p>
            Editing a student works in almost the exact same way as creating a
            student.
          </p>
          <p>
            The difference is that we need to retrieve the student
            from the database first so we know which object we're going to
            update.
          </p>
        </section>

        <section>
          <h2>Editing A Student</h2>
          <p>
            Look at the <code>edit</code> action:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
def edit
end
          </code></pre>
          <p class="fragment">
            OK, so it's empty. But what about the view?
          </p>
          <pre class="fragment"><code class="erb" data-trim>
&lt;h1>Editing Student&lt;/h1>

&lt;%= render 'form', student: @student %>

&lt;%= link_to 'Show', @student %> |
&lt;%= link_to 'Back', students_path %>
          </code></pre>
          <p class="fragment">
            It's rendering the form while passing the <code>@student</code>
            variable to it.
          </p>
        </section>

        <section>
          <h2>Team Challenge</h2>
          <p>
            Where did the <code>@student</code> variable get set?
          </p>
          <div class="fragment">
            <br>
            <h3>Answer</h3>
            <p>
              Look at the top of the controller:
            </p>
            <pre class="fragment"><code class="ruby" data-trim>
  before_action :set_student, only: [:show, :edit, :update, :destroy]
            </code></pre>
            <p class="fragment">
              This tells the controller to run the <code>set_student</code>
              method before the action is processed, but only for the show, edit
              update, and destroy actions.
            </p>
            <p class="fragment">
              Find <code>set_student</code>. It's a private method.
            </p>
            <pre class="fragment"><code class="ruby" data-trim>
  def set_student
    @student = Student.find(params[:id])
  end
            </code></pre>
            <p class="fragment">
              Notice how it sets the <code>@student</code> variable.
              <br>
              This is a great way to be DRY and share code among actions.
            </p>
          </div>
        </section>

        <section>
          <h2>Editing A Student</h2>
          <pre><code class="ruby" data-trim>
@student = Student.find(params[:id])
          </code></pre>
          <p class="fragment">
            In this case, <code>find</code> is also making a call to the
            database. It requires that an <code>id</code> be passed to it.
            <br>
            (We will explore this idea more a bit later.)
          </p>
          <p class="fragment">
            <code>params</code> is a <code>hash</code> of parameters available
            to the controller.
          </p>
        </section>

        <section>
          <h2>Editing A Student</h2>
          <p>
            Look at your current URL: Something like
            <code>/students/1/edit</code>. Remember <code>rails routes</code>
            for the edit action?
          </p>
          <pre class="fragment"><code class="console" data-trim>
edit_student GET    /students/:id/edit(.:format) students#edit
          </code></pre>
          <p class="fragment">
            In this case, <code>:id</code> represents a varying parameter.
            In our case, <code>1</code> is available through
            <code>params[:id]</code>
          </p>
          <p class="fragment">
            That means this:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
@student = Student.find(params[:id])
          </code></pre>
          <p class="fragment">
            Resolves to this:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
@student = Student.find(1)
          </code></pre>
          <p class="fragment">
            So we are returned the student with an <code>id</code> of
            <code>1</code>.
          </p>
        </section>

        <section>
          <h2>Editing A Student</h2>
          <p>
            The other big difference between creating and updating is that your
            <code>update</code> action calls
            <code>@student.update(student_params)</code> instead of
            <code>Student.new(student_params)</code>.
          </p>
          <p class="fragment">
            <code>.update</code> is another method used to update an object
            that already exists in the database.
          </p>
        </section>

        <section>
          <h2>Deleting A Student</h2>
          <p>
            By now, hopefully this process is familiar. When we hit the
            <code>destroy</code> action, we:
          </p>
          <ul>
            <li class="fragment">retrieve the student</li>
            <li class="fragment">
              call <code>@student.destroy</code> (which deletes the record from
              the database)
            </li>
            <li class="fragment">redirect to the <code>index</code> action</li>
          </p>
        </section>

        <section data-background-image="https://media.giphy.com/media/LSNqpYqGRqwrS/giphy.gif">
          <h2 class="text-white">Celebrate!</h2>
          <p class="text-white">You just learned the basics of a Rails app!</p>
        </section>

        <section>
          <h2>Homework!</h2>
          <ol>
            <li class="fragment">
              Create a teacher model with the appropriate controller and views.
              The teacher should be required to have a name, and should also
              have a hired date called <code>hired_at</code>.
            </li>
            <li class="fragment">
              Add a way to be able to navigate to the students index and
              teachers index from any page on the app.
            </li>
          </ol>
        </section>

        <section>
          <h1>
            Session 3:
            <br>
            <small>Data Relationships</small>
          </h1>
        </section>

        <section>
          <h2>Homework: Solution!</h2>
          <p class="fragment">
            Run the scaffold generator:
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ rails generate scaffold teacher name:string hired_at:date
          </code></pre>
          <p class="fragment">
            Run the migration:
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ rails db:migrate
          </code></pre>
          <p class="fragment">
            Add the validation to the model:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
validates_presence_of :name
          </code></pre>
        </section>

        <section>
          <h2>Homework: Solution!</h2>
          <p class="fragment">
            Build a header with links to students and teachers.
            <br>
            The next few slides will cover this solution.
          </p>
        </section>

        <section>
          <h2>Shared Header</h2>
          <p>
            Have you noticed something missing?
          </p>
          <p class="fragment">
            The only HTML we've talked about are little snippets. What about the
            rest of the HTML. Where does it come from?
          </p>
          <p class="fragment">
            <code>app/views/layouts/application.html.erb</code>
          </p>
          <p class="fragment">
            <br>
            There it is! How do our views get plugged into this?
          </p>
          <p class="fragment">
            They are rendered where you see <code><%= yield %></code>.
          </p>
          <p class="fragment">
            <br>
            Try it. Add some HTML to the body of the layout and see if it
            shows up in the browser!
          </p>
        </section>

        <section>
          <h2>Shared Header</h2>
          <p>
            Right inside the layout, we can add a header:
          </p>
          <pre class="fragment"><code class="erb" data-trim>
&lt;body><mark>
  &lt;header>
    &lt;h1>
      &lt;%= link_to 'GreatGraders', root_path %>
    &lt;/h1>
    &lt;ul>
      &lt;li>
        &lt;%= link_to 'Students', students_path %>
      &lt;/li>
      &lt;li>
        &lt;%= link_to 'Teachers', teachers_path %>
      &lt;/li>
    &lt;/ul>
    &lt;hr>
  &lt;/header></mark>
  &lt;%= yield %>
&lt;/body>
          </code></pre>
          <p class="fragment">
            It works, but it's pretty ugly.
            <br>
            Why don't we move it into its own partial?
          </p>
        </section>

        <section>
          <h2>Shared Header</h2>
          <p>
            Let's take the code we added and move it to a partial at
            <code>app/views/application/_header.html.erb</code>
          </p>
          <p class="fragment">
            In the layout, we simply need to make sure we render that partial.
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
&lt;body>
  <mark>&lt;%= render 'header' %></mark>
  &lt;%= yield %>
&lt;/body>
          </code></pre>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            Now we need to find a way to group students and teachers together,
            so we can track the students each teacher is responsible for.
          </p>
        </section>

        <section>
          <h2>Team Challenge</h2>
          <p>
            How do I create a "Classroom" scaffold where each classroom
            has a room number as an integer?
          </p>
          <div class="fragment">
            <br>
            <h3>Answer</h3>
            <pre><code class="console" data-trim>
$ rails generate scaffold classroom room_number:integer
            </code></pre>
          </div>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            Don't forget to add a validation so we can't create blank
            classrooms.
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
class Classroom < ApplicationRecord
  <mark>validates_presence_of :room_number</mark>
end
          </code></pre>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            Now we want to make sure we can navigate to classrooms from the
            header
          </p>
          <pre class="fragment"><code class="erb" data-trim>
&lt;li>
  &lt;%= link_to 'Classrooms', classrooms_path %>
&lt;/li>
          </code></pre>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            But how do we connect teachers and students to a classroom?
          </p>
          <p class="fragment">
            That's where associations come in.
          </p>
          <p class="fragment">
            We want a new column on teacher and students to assign them to
            a classroom.
          </p>
          <p class="fragment">
            This is called a one-to-many relationship, because one classroom
            has many teachers/students.
          </p>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            To change an existing table we use a custom migration.
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ rails generate migration add_classroom_id_to_students_and_teachers
          </code></pre>
          <p class="fragment">
            The name we chose for the migration is abitrary, but is meant to be
            semantic and representative of the desired action.
          </p>
          <p class="fragment">
            Notice the output:
          </p>
          <pre class="fragment"><code class="console" data-trim>
      invoke  active_record
      create    db/migrate/20170604130906_add_classroom_id_to_students_and_teachers.rb
          </code></pre>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            Go find that file and customize it with your new columns:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
class AddClassroomIdToStudentsAndTeachers < ActiveRecord::Migration[5.1]
  def change
    add_column :students, :classroom_id, :integer
    add_column :teachers, :classroom_id, :integer
  end
end
          </code></pre>
          <p class="fragment">
            This tells rails to add a <code>classroom_id</code> column to the
            students table and the teachers table.
          </p>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            Now we can migrate:
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ rails db:migrate
          </code></pre>
          <p class="fragment">
            But rails still doesn't know it has an association. You have to
            inform rails that you want the models associated.
          </p>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            For the student and teacher model, you want to say they each
            <strong>belong to</strong> a classroom.
          </p>
          <p class="fragment">
            The resulting student model:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
class Student < ApplicationRecord

  <mark>belongs_to :classroom</mark>

  validates_presence_of :name

end
          </code></pre>
          <p class="fragment">
            Do the same thing for teachers.
          </p>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            Classrooms <em>have many</em> students and teachers.
            <br>
            Its model looks like this:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
class Classroom < ApplicationRecord
<mark>
  has_many :students
  has_many :teachers</mark>

  validates_presence_of :room_number

end
          </code></pre>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            Now we need to be able to assign a student and teacher to a
            classroom.
          </p>
          <p class="fragment">
            First, we want to add the <code>classroom_id</code> to the student
            form.
          </p>
          <pre class="fragment"><code class="html" data-trim>
&lt;div class="field">
  &lt;%= form.label :classroom_id %>
  &lt;%= select student, :classroom_id, @classrooms %>
&lt;/div>
          </code></pre>
        </section>

        <section>
          <h2>Team Challenge</h2>
          <p>
            The code you just added caused an error! Why?
          </p>
          <div class="fragment">
            <br>
            <h3>Answer</h3>
            <p>
              Because we didn't set <code>@classrooms</code> to anything.
            </p>
          </div>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            Make it available in the students controller:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
before_action :set_classrooms, only: [:new, :create, :edit, :update]

# ...

private

  def set_classrooms
    @classrooms = Classroom.all
  end
          </code></pre>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            That works but it's super ugly, isn't it?
            <br>
            How do we know which classroom is which?
          </p>
          <p class="fragment">
            Rails uses the <code>to_s</code> instance method to resolve the
            value for this select.
          </p>
          <p class="fragment">
            Unfortunately, adjusting this will lead to another issue, so let's
            try this instead:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
def set_classrooms
  @classrooms = Classroom.all.collect { |c| [c.room_number, c.id] }
end
          </code></pre>
          <p class="fragment">
            Refresh the student form and it should look good and work fine.
          </p>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            Now, do the same thing, but to teachers.
          </p>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            It's great once it works, but we aren't sure which classroom
            teachers and students are in without going into the form view.
          </p>
          <p class="fragment">
            So, let's add that visibility to the index views.
          </p>
          <pre class="fragment"><code class="erb" data-trim>
&lt;table>
  &lt;thead>
    &lt;tr>
      &lt;th>Name&lt;/th>
      &lt;th>Age&lt;/th>
      <mark>&lt;th>Classroom&lt;/th></mark>
      &lt;th colspan="3">&lt;/th>
    &lt;/tr>
  &lt;/thead>

  &lt;tbody>
    &lt;% @students.each do |student| %>
      &lt;tr>
        &lt;td>&lt;%= student.name %>&lt;/td>
        &lt;td>&lt;%= student.age %>&lt;/td>
        <mark>&lt;td>&lt;%= student.classroom_id %>&lt;/td></mark>
        &lt;td>&lt;%= link_to 'Show', student %>&lt;/td>
        &lt;td>&lt;%= link_to 'Edit', edit_student_path(student) %>&lt;/td>
        &lt;td>&lt;%= link_to 'Delete', student, method: :delete, data: { confirm: 'Are you sure?' } %>&lt;/td>
      &lt;/tr>
    &lt;% end %>
  &lt;/tbody>
&lt;/table>
          </code></pre>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            That works, but wouldn't we rather have the room number?
          </p>
          <pre class="fragment"><code class="erb" data-trim>
<td><%= student.classroom.room_number %></td>
          </code></pre>
          <p class="fragment">
            WARNING! This causes what we call an N+1 problem.
            <br>
            (Solving it is outside the scope of this course, but Google will
            help!)
          </p>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            Do the same thing for teachers.
          </p>
        </section>

        <section>
          <h2>Grouping Students and Teachers</h2>
          <p>
            On a classroom show view, say we wanted to list the students and
            teachers, how would we do that?
          </p>
          <p class="fragment">
            Maybe something like this?
          </p>
          <pre class="fragment"><code class="erb" data-trim>
&lt;h2>Teachers&lt;/h2>
&lt;ul>
  &lt;% @classroom.teachers.each do |teacher| %>
    &lt;li>&lt;%= teacher.name %>&lt;/li>
  &lt;% end %>
&lt;/ul>

&lt;h2>Students&lt;/h2>
&lt;ul>
  &lt;% @classroom.students.each do |student| %>
    &lt;li>&lt;%= student.name %>&lt;/li>
  &lt;% end %>
&lt;/ul>
          </code></pre>
        </section>

        <section>
          <h2>Pause for Ruby Magic</h2>
          <p>
            This is outside the scope of our class, but check this out.
            <br>
            You can write the same code from the previous slide like this:
          </p>
          <pre class="fragment"><code class="erb" data-trim>
&lt;% [Student, Teacher].each do |model| %>
  &lt;h2>&lt;%= model.to_s.pluralize.titleize %>&lt;/h2>
  &lt;ul>
    &lt;% @classroom.send(model.table_name).each do |obj| %>
      &lt;li>&lt;%= obj.name %>&lt;/li>
    &lt;% end %>
  &lt;/ul>
&lt;% end %>
          </code></pre>
        </section>

        <section>
          <h2>Homework!</h2>
          <p>
            Create a home page that isn't the index views of any of the
            controllers we've create so far.
          </p>
          <p>
            Hint: You'll probably want a new controller and view (and don't
            forget the route.)
          </p>
        </section>

        <section>
          <h1>
            Session 4: Bonus!
            <br>
            <small>Deploy To Heroku</small>
          </h1>
        </section>

        <section>
          <h2>Homework: Solution!</h2>
          <p class="fragment">
            Create a controller:
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ rails generate controller pages
          </code></pre>
          <p class="fragment">
            Add a home action:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
class PagesController < ApplicationController
  def home
  end
end
          </code></pre>
          <p class="fragment">
            Add the view at <code>app/views/pages/home.html.erb</code>.
          </p>
          <p class="fragment">
            Change the root route in <code>config/routes.rb</code>.
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
root to: 'pages#home'
          </code></pre>
        </section>

        <section>
          <h2>Deploying To Heroku!</h2>
          <p>
            First things, first, sign up for a Heroku account
            (https://heroku.com).
          </p>
          <p class="fragment">
            Create a new app and give it a unique name.
          </p>
        </section>

        <section>
          <h2>Deploying To Heroku!</h2>
          <p>
            Login to Heroku on the command line
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ heroku login
          </code></pre>
          <p class="fragment">
            And let's add git and register our project.
            (Git is the coolest tool ever, and GDI offers a course on it.)
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ git init
$ heroku git:remote -a [APP_NAME]
          </code></pre>
        </section>

        <section>
          <h2>Deploying To Heroku!</h2>
          <p>
            Next, we have to add a git commit to be able to deploy.
          </p>
          <p>
            You'll have to do this every time you make a new change you want
            to deploy.
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ git add .
$ git commit -am "make it better"
          </code></pre>
          <p class="fragment">
            Now, deploy!
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ git push heroku master
          </code></pre>
        </section>

        <section>
          <h2>Deploying To Heroku!</h2>
          <p>
            Oh no! It broke because we don't have our database configured
            correctly for heroku.
          </p>
          <p class="fragment">
            Heroku uses PostgreSQL for its database, so we need to set that
            up for production.
          </p>
          <p class="fragment">
            First, in our Gemfile, adjust the sqlite3 gem and add pg for
            production only:
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
group :development, :test do
  gem 'sqlite3'
end

group :production do
  gem 'pg'
end
          </code></pre>
        </section>

        <section>
          <h2>Deploying To Heroku!</h2>
          <p>
            Then in the database configuration change the production section.
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
production:
  adapter: postgresql
  database: gdi_app_production
  pool: 5
  timeout: 5000
          </code></pre>
        </section>

        <section>
          <h2>Deploying To Heroku!</h2>
          <p>
            Commit the change:
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ git add .
$ git commit -m "postgres"
          </code></pre>
          <p class="fragment">
            And deploy again:
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ git push heroku master
          </code></pre>
        </section>

        <section>
          <h2>Deploying To Heroku!</h2>
          <p>
            Oh farts! The dreaded Rails production error:
          </p>
          <img src="img/rails-500.png" alt="">
        </section>

        <section>
          <h2>Deploying To Heroku!</h2>
          <p>
            You can inspect the logs from Heroku:
          </p>
          <pre class="fragment"><code class="console" data-trim>
$ heroku logs
          </code></pre>
          <p class="fragment">
            Notice the error message:
          </p>
          <pre class="fragment"><code class="console" data-trim>
ActionView::Template::Error (PG::UndefinedTable: ERROR:  relation "students" does not exist
          </code></pre>
        </section>

        <section>
          <h2>Team Challenge</h2>
          <p>
            What is the solution to the error?
          </p>
          <div class="fragment">
            <br>
            <h3>Answer</h3>
            <p>
              Migrate the production database on the Heroku server.
            </p>
            <pre><code class="console" data-trim>
$ heroku run rails db:migrate
            </code></pre>
          </div>
        </section>

        <section>
          <h2>Deploying To Heroku!</h2>
          <p>
            Check the app now and it should be working properly!
          </p>
        </section>

        <section data-background-image="https://media.giphy.com/media/axu6dFuca4HKM/giphy.gif">
          <h2 class="text-white">You built and deployed a Rails app!!!</h2>
        </section>

        <section>
          <h1>Bonus Material</h1>
        </section>

        <section>
          <h2>The Asset Pipeline</h2>
          <p>
            Rails comes with an asset pipeline that helps properly deliver
            all your app's assets, such as stylesheets, javascripts, images,
            font, videos, etc.
          </p>
          <p class="fragment">
            These are all (or <em>mostly</em>) in <code>app/assets</code>
          </p>
          <p class="fragment">
            Two files --
            <code>app/assets/stylesheets/application.css</code> and
            <code>app/assets/javascripts/application.js</code> --
            are the main stylesheet and javascript files so everything is
            compiled into one place.
          </p>
        </section>

        <section>
          <h2>Ruby Gems</h2>
          <p>
            Gems are super useful. Checkout popular ones like Devise,
            SimpleForm, Paperclip, Kaminari.
          </p>
          <p class="fragment">
            Let's combine the asset pipeline and a gem together.
          </p>
        </section>

        <section>
          <h2>Bootstrap</h2>
          <p>
            Boostrap is a popular CSS framework that makes apps look good
            (well, <em>not horrible</em>) without much effort.
          </p>
          <p class="fragment">
            Let's add Boostrap to our Gemfile
          </p>
          <pre class="fragment"><code class="ruby" data-trim>
gem 'bootstrap-sass'
          </code></pre>
        </section>

        <section>
          <h2>Bootstrap</h2>
          <p>
            Next, rename <code>application.css</code> to
            <code>application.scss</code> so we can take advantage of Sass.
          </p>
          <p class="fragment">
            Then import Bootstrap into your styles.
          </p>
          <pre class="fragment"><code class="scss" data-trim>
@import 'bootstrap-sprockets';
@import 'bootstrap';
          </code></pre>
          <p class="fragment">
            And restart your rails server. This is usually a good idea
            after adding a new gem.
          </p>
          <p class="fragment">
            It already looks better!
          </p>
        </section>

        <section>
          <h2>Bootstrap</h2>
          <p>
            Now we can use some Bootstrap conventions to make it looks even
            nicer.
          </p>
          <p class="fragment">
            For example, let's format the header the way Bootstrap would like.
          </p>
          <pre class="fragment"><code class="html" data-trim>
&lt;header>
  &lt;nav class="navbar navbar-default">
    &lt;div class="container-fluid">
      &lt;div class="navbar-header">
        &lt;%= link_to 'GreatGraders', root_path, class: 'navbar-brand' %>
      &lt;/div>
      &lt;ul class="nav navbar-nav navbar-right">
        &lt;li>
          &lt;%= link_to 'Students', students_path %>
        &lt;/li>
        &lt;li>
          &lt;%= link_to 'Teachers', teachers_path %>
        &lt;/li>
        &lt;li>
          &lt;%= link_to 'Classrooms', classrooms_path %>
        &lt;/li>
      &lt;/ul>
    &lt;/div>
  &lt;/nav>
&lt;/header>
          </code></pre>
        </section>

        <section>
          <h2>Bootstrap</h2>
          <p>
            We could also wrap all our content in a conainter so it
            doesn't stretch too wide.
          </p>
          <pre class="fragment"><code class="html" data-trim>
&lt;%= render 'header' %>

&lt;div class="container">
  &lt;%= yield %>
&lt;/div>
          </code></pre>
          <p class="fragment">
            And your tables will instantly look better if you add the
            <code>table</code> class to all of them.
          </p>
        </section>

        <section>
          <h2>Testing</h2>
          <p>
            Testing is invaluable and should become part of your practice
            once you're comfortable within the framework.
          </p>
          <p class="fragment">
            Testing helps prevent regression (bugs) when your app becomes
            large.
          </p>
          <p class="fragment">
            Rails ships with TestUnit, but many replace it with RSpec.
          </p>
        </section>

        <section>
          <h2>Resources</h2>
          <ul>
            <li class="fragment">
              Google!
            </li>
            <li class="fragment">
              GDI Slack (when appropriate)
            </li>
            <li class="fragment">
              <a href="https://www.railstutorial.org/book">
                Michael Hartl's Book
              </a>
            </li>
            <li class="fragment">
              <a href="https://medium.com/ruby-on-rails/learning-ruby-on-rails-in-2016-from-the-best-resources-ecffb36a1fb1">
                And lots more
              </a>
            </li>
          </ul>
        </section>

        <section>
          <h2>Homework!</h2>
          <p class="fragment">
            There's a ton we didn't touch upon here, because Rails keeps
            going. You will do all kinds of crazy stuff if you keep with it.
          </p>
          <p class="fragment">
            Stick with it. Pick a project and see it through.
          </p>
          <p class="fragment">
            Google before you ask, but don't be afraid to ask.
          </p>
        </section>

        <section data-background-image="https://media.giphy.com/media/l2YWjjzDaZHTowGLm/giphy.gif">
        </section>
      </div>
    </div>

    <script src="js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>
    <!--<script src="plugins/highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>-->

    <!--<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">-->
    <!--<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>-->
    <script src="plugins/highlight/highlight.pack.js"></script>
    <script src="plugins/notes/notes.js"></script>
    <!-- <script src="plugins/notes-server/index.js"></script> -->

    <script>hljs.initHighlightingOnLoad();</script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom
      });

    </script>

  </body>
</html>
